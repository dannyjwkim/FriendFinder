<!DOCTYPE html>
<html>

<head>
  <title>Match with an Instructor Survey</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <!-- Chosen jQuery Plugin-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.7.0/chosen.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.7.0/chosen.jquery.min.js"></script>
</head>

<body>

  <div class="container" id="survey">

    <h2>Survey Questions</h2>
    
    <hr>

    <h4>Name (Required)</h4>
    <input type="text" name="" id="name" class="form-control" required>
    
    <h4>Please enter a link to any Photo image of yourself (Required)</h4>
    <input type="text" name="" id="photo" class="form-control" required>
    
    <hr>

    <h3><strong>Question 1</strong></h3>
    <h4>Mac > PC</h4>
      <select data-placeholder="" class="chosen-select" id="q1">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>

    <h3><strong>Question 2</strong></h3>
    <h4>Friday night = "Yes, I can finally code what I want!"</h4>
      <select data-placeholder="" class="chosen-select" id="q2">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>
    
    <h3><strong>Question 3</strong></h3>
    <h4>I am earlier than "early adopters"</h4>
      <select data-placeholder="" class="chosen-select" id="q3">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>

    <h3><strong>Question 4</strong></h3>
    <h4>I would LOVE for my children to be developers</h4>
      <select data-placeholder="" class="chosen-select" id="q4">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>

    <h3><strong>Question 5</strong></h3>
    <h4>"A new library/technology came out? Yayyyy!"</h4>
      <select data-placeholder="" class="chosen-select" id="q5">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>

    <h3><strong>Question 6</strong></h3>
    <h4>24-hour hack-a-thons sound (or still sound) fun!</h4>
      <select data-placeholder="" class="chosen-select" id="q6">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>

    <h3><strong>Question 7</strong></h3>
    <h4>Pair programming? Why not trio/quad programming?!</h4>
      <select data-placeholder="" class="chosen-select" id="q7">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>

    <h3><strong>Question 8</strong></h3>
    <h4>I am willing to give up some privacy if it leads to a lot of convenience</h4>
      <select data-placeholder="" class="chosen-select" id="q8">
        <option value=""></option>
        <option value="1">1 (Strongly Disagree)</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5 (Strongly Agree)</option>
      </select>

    <h3><strong>Question 9</strong></h3>
    <h4>I wish I didn't need to sleep so I could do more</h4>
      <select data-placeholder="" class="chosen-select" id="q9">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
      </select>

    <h3><strong>Question 10</strong></h3>
    <h4>People like me</h4>
      <select data-placeholder="" class="chosen-select" id="q10">
          <option value=""></option>
          <option value="1">1 (Strongly Disagree)</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5 (Strongly Agree)</option>
      </select>
    
    <br>
    <br>

    <button type="submit" class="btn btn-primary btn-lg btn-block" id="submit" style="background-color:green"><i class="fa fa-check-circle" aria-hidden="true"></i>Submit</button>

    <hr>
    
    <footer class="footer">
      <div class="container">
        <a href="/api/friends" class="footer-links" target="_blank">API Friends List</a> |
        <a href="https://github.com/dannyjwkim/FriendFinder" target="_blank" class="footer-links">Git Hub Repo</a>
      </div>
    </footer>

  </div>

  <!-- MODAL -->
  <div id="resultsModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">

        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h2 class="modal-title"><strong>Your Instructor Match</strong></h2>
        </div>

        <div class="modal-body">
          <h2 id="matchName"></h2>
          <img id="matchImg" alt="">
        </div>

        <div class="modal-footer">
          <button id="close" type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>

      </div>
    </div>
  </div>

<script type="text/javascript">

//"CHOSEN" jQuery PLUGIN THAT MAKES SELECT BOXES MORE USER FRIENDLY
$('select, input').attr("required", "required");
var config = {
  '.chosen-select': {},
  '.chosen-select-deselect': {
    allow_single_deselect: true
  },
  '.chosen-select-no-single': {
    disable_search_threshold: 10
  },
  '.chosen-select-no-results': {
    no_results_text: 'Oops, no result!'
  },
  '.chosen-select-width': {
    width: "95%"
  }
}

for (var selector in config) {
  $(selector).chosen(config[selector]);
}

// CAPTURES THE FORM INPUTS  
$("#submit").on("click", function() {
  // VALIDATES THE FORM 
  function validateForm() {
    var isValid = true;
      $('.form-control').each(function() {
        if ($(this).val() === '')
          isValid = false;
      });
      $('.chosen-select').each(function() {
        if ($(this).val() === "")
          isValid = false
      })
      return isValid;
  }

  // SET BOOLEAN TO CHECK ALL FIELDS SUBMITTED
  if (validateForm() == true) {

    // CREATE AN OBJECT TO HOLD THE USER INPUTTED DATA 
    var userData = {
      name:    $("#name").val(),
      photo:   $("#photo").val(),
      scores: [$("#q1").val(), $("#q2").val(), $("#q3").val(), $("#q4").val(), $("#q5").val(), $("#q6").val(), $("#q7").val(), $("#q8").val(), $("#q9").val(), $("#q10").val()]
    }
    
    // THEN GRAB THE CURRENT URL
    var currentURL = window.location.origin;

    // THEN POST USER INPUTTED DATA TO THE FRIENDS API
    $.post(currentURL + "/api/friends", userData, function(data) {

      // GRAB THE BEST MATCH RESULT NAME and PHOTO
      $("#matchName").text(data.name);
      $("#matchImg").attr("src", data.photo);

      // DISPLAYS THE BEST MATCH WITHIN THE MODAL
      $("#resultsModal").modal('toggle');

    });

  } else {
      alert("Please fill out all required fields before submitting!");
  }
  
  // RELOAD THE PAGE UPON CLICKING THE MODAL CLOSE BUTTON
  $("#close").on("click", function() {
    $.get("/survey", function(req, res) {
      location.reload();
    });
  });

  return false;

});

</script>

</body>

</html>